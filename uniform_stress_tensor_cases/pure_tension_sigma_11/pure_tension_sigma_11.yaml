# -----------------------------------------------------------------------------------------------------------
# Flow123d Input File
# Project: Internship CTU 2026
# Author: Ronald Ch. Siddall
# Description: Linear elastic cube, pure tension 
# Stress tensor is of the form:
#	 | sigma_11	sigma_12	sigma_13 |   in this case |1e6	0   0 |
# sigma =| sigma_21	sigma_22	sigma_23 |        => 	  | 0	0   0 |
#	 | sigma_31 	sigma_32	sigma_33 |                | 0 	0   0 |
# -----------------------------------------------------------------------------------------------------------
# The goal: create a statically determinate support of the lower surface in the yz plane, afterwards apply a 
# boundary condition on the top surface via uniform traction creating nonzero displacement and stress fields
# Specifically in this case we see that only one component is non zero = stress sigma_11 =  defined traction
# Since it is NOT possible to prescribe the individual displacement components for specific points i.e.:
#	Point with coordinates (0, 0, 0): u_x = 0, u_y = 0, u_z = 0 takes away 3 degrees of freedom (DOFs)
#	Point with coordinates (1, 0, 0): u_y = 0, u_z = 0 takes aways 2 degrees of freedom
#	Point with coordinates (0, 1, 0): u_z = 0 takes away 1 degree of freedom 
# Using roller supports (zero normal displacement) on the "minus" planes is required
# This provides the same statically determinate support (6 DOFs taken away)
# while still allowing the cube to freely contract in transverse directions due to Poissons effect
# ------------------------------------------------------------------------------------------------------------

flow123d_version: 3.9.0

problem: !Coupling_Sequential
  description: "3D linear elastic cube"
  mesh:
    mesh_file: ../uniform_stress_cube_3d.msh

  flow_equation: !Coupling_Iterative
    input_fields:
      - region: rock
    time:
      end_time: 1.0
    a_tol: 1e-12
    r_tol: 1e-12

    flow_equation: !Flow_Darcy_LMH
      gravity: [0, 0, 0]
      input_fields:
        - region: rock
          init_pressure: 0
        - region: .BOUNDARY
          bc_type: dirichlet
          bc_pressure: 0
      output:
        fields: []

    mechanics_equation: !Elasticity_Linear
      output_stream:
        file: mechanics.pvd
        format: !vtk
          variant: ascii
      output:
        fields:
          - displacement
          - stress
          - region_id
      solver: !Petsc
        a_tol: 1e-12
        r_tol: 1e-12

      input_fields:
        - region: rock
          young_modulus: 1e9  
          poisson_ratio: 0.25

        - region: [.surface_x_minus, .surface_y_minus, .surface_z_minus]
          bc_type: displacement_n
          bc_displacement: 0.0

        - region: .surface_x_plus
          bc_type: traction
          bc_traction: [1e6, 0, 0]